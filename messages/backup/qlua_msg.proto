syntax = "proto3";

package qlua.procs;

//
// At the moment of writing (23 September 2017), the protoc-gen-lua plugin from https://github.com/urbanairship/protobuf-lua
// cannot generate valid Lua code in the case when multiple .proto files involved and 
// there are imports in them.
// Thus the definitions have to be in a single large pile for a while.
//

enum ProcedureType {

    PROCEDURE_TYPE_UNKNOWN = 0;
    IS_CONNECTED = 1;
    GET_SCRIPT_PATH = 2;
    GET_INFO_PARAM = 3;
    MESSAGE = 4;
    SLEEP = 5;
    GET_WORKING_FOLDER = 6;
    PRINT_DBG_STR = 7;
    GET_ITEM = 8;
    GET_ORDER_BY_NUMBER = 9; // NOT TESTED YET
    GET_NUMBER_OF = 10;
    SEARCH_ITEMS = 11;
    GET_CLASSES_LIST = 12;
    GET_CLASS_INFO = 13;
    GET_CLASS_SECURITIES = 14;
    GET_MONEY = 15;
    GET_MONEY_EX = 16;
    GET_DEPO = 17;
    GET_DEPO_EX = 18;
    GET_FUTURES_LIMIT = 19;
    GET_FUTURES_HOLDING = 20;
    GET_SECURITY_INFO = 21;
    GET_TRADE_DATE = 22;
    GET_QUOTE_LEVEL2 = 23;
    
    GET_LINES_COUNT = 24;
    GET_NUM_CANDLES = 25;
    GET_CANDLES_BY_INDEX = 26;
    
    CREATE_DATA_SOURCE = 27;
    DS_SET_UPDATE_CALLBACK = 28;
    DS_O = 29;
    DS_H = 30;
    DS_L = 31;
    DS_C = 32;
    DS_V = 33;
    DS_T = 34;
    DS_SIZE = 35;
    DS_CLOSE = 36;
    DS_SET_EMPTY_CALLBACK = 37;
    
    SEND_TRANSACTION = 38;
    CALC_BUY_SELL = 39; // NOT TESTED YET
    
    GET_PARAM_EX = 40;
    GET_PARAM_EX_2 = 41; // NB: использовать структуры запроса и ответа от GET_PARAM_EX
    
    GET_PORTFOLIO_INFO = 42;
    GET_PORTFOLIO_INFO_EX = 43;
    
    GET_BUY_SELL_INFO = 44;
    GET_BUY_SELL_INFO_EX = 45; // NB: использовать структуры запроса и ответа от GET_BUY_SELL_INFO
    
    ADD_COLUMN = 46; // нужно бы ещё потестить, т.к. после добавления одного столбца другие добавляются, но визуально не отображаются
    ALLOC_TABLE = 47;
    CLEAR = 48;
    CREATE_WINDOW = 49;
    DELETE_ROW = 50;
    DESTROY_TABLE = 51;
    INSERT_ROW = 52; // NB: использовать после создания окна для таблицы (процедура CREATE_WINDOW)
    IS_WINDOW_CLOSED = 53;
    GET_CELL = 54;
    GET_TABLE_SIZE = 55;
    GET_WINDOW_CAPTION = 56;
    GET_WINDOW_RECT = 57;
    SET_CELL = 58;
    SET_WINDOW_CAPTION = 59;
    SET_WINDOW_POS = 60;
    SET_TABLE_NOTIFICATION_CALLBACK = 61;
    RGB = 62; // NB: на самом деле, библиотечная функция RGB должна называться BGR, ибо она выдаёт числа именно в этом формате. В SetColor, однако, тоже ожидается цвет в формате BGR, так что это не баг, а фича.
    SET_COLOR = 63;
    HIGHLIGHT = 64;
    SET_SELECTED_ROW = 65;

    ADD_LABEL = 66;
    DEL_LABEL = 67;
    DEL_ALL_LABELS = 68;
    GET_LABEL_PARAMS = 69;
    SET_LABEL_PARAMS = 70;
    
    SUBSCRIBE_LEVEL_II_QUOTES = 71; // NOT IMPLEMENTED YET
    UNSUBSCRIBE_LEVEL_II_QUOTES = 72; // NOT IMPLEMENTED YET
    IS_SUBSCRIBED_LEVEL_II_QUOTES = 73; // NOT IMPLEMENTED YET
    
    PARAM_REQUEST = 74;
    CANCEL_PARAM_REQUEST = 75;
    
    BIT_TOHEX = 76;
    BIT_BNOT = 77;
    BIT_BAND = 78;
    BIT_BOR = 79;
    BIT_BXOR = 80;
}

// Не получилось внедрить это определение в AddColumn_Request, т.к. не смог потом залукапить значения енама
enum ColumnParameterType {

    COLUMN_PARAMETER_TYPE_UNKNOWN = 0;
    QTABLE_INT_TYPE = 1;
    QTABLE_DOUBLE_TYPE = 2;
    QTABLE_INT64_TYPE = 3;
    QTABLE_CACHED_STRING_TYPE = 4;
    QTABLE_TIME_TYPE = 5;
    QTABLE_DATE_TYPE = 6;
    QTABLE_STRING_TYPE = 7;
}

enum Interval {

    INTERVAL_UNKNOWN = 0;
    INTERVAL_TICK = 1;
    INTERVAL_M1 = 2;
    INTERVAL_M2 = 3;
    INTERVAL_M3 = 4;
    INTERVAL_M4 = 5;
    INTERVAL_M5 = 6;
    INTERVAL_M6 = 7;
    INTERVAL_M10 = 8;
    INTERVAL_M15 = 9;
    INTERVAL_M20 = 10;
    INTERVAL_M30 = 11;
    INTERVAL_H1 = 12;
    INTERVAL_H2 = 13;
    INTERVAL_H4 = 14;
    INTERVAL_D1 = 15;
    INTERVAL_W1 = 16;
    INTERVAL_MN1 = 17;
}

enum MessageIconType {

    MESSAGE_ICON_TYPE_UNDEFINED = 0;
    MESSAGE_ICON_TYPE_INFO = 1;
    MESSAGE_ICON_TYPE_WARNING = 2;
    MESSAGE_ICON_TYPE_ERROR = 3;
}

message DateTimeEntry {

    string mcs = 1; // not sure if it's integral, so leave it be string until figured out
    string ms = 2; // not sure if it's integral, so leave it be string until figured out
    int32 sec = 3;
    int32 min = 4;
    int32 hour = 5;
    int32 day = 6;
    int32 week_day = 7;
    int32 month = 8;
    int32 year = 9;
}

message CandleEntry {

    string open = 1;
    string close = 2;
    string high = 3;
    string low = 4;
    string volume = 5;
    int32 does_exist = 6;
    DateTimeEntry datetime = 7;
}

message TableEntry {

    string k = 1;
    string v = 2;
}

enum EventType {

    EVENT_TYPE_UNKNOWN = 0;
    PUBLISHER_ONLINE = 1; // no data attached
    PUBLISHER_OFFLINE = 2; // no data attached
    ON_CLOSE = 3; // no data attached
    ON_CONNECTED = 4; // no data attached
    ON_DISCONNECTED = 5; // no data attached
    ON_FIRM = 6; 
    ON_ALL_TRADE = 7; 
    ON_TRADE = 8; 
    ON_ORDER = 9;
    ON_ACCOUNT_BALANCE = 10;
    ON_FUTURES_LIMIT_CHANGE = 11;
    ON_FUTURES_LIMIT_DELETE = 12;
    ON_FUTURES_CLIENT_HOLDING = 13;
    ON_MONEY_LIMIT = 14;
    ON_MONEY_LIMIT_DELETE = 15;
    ON_DEPO_LIMIT = 16;
    ON_DEPO_LIMIT_DELETE = 17;
    ON_ACCOUNT_POSITION = 18;
    ON_NEG_DEAL = 19;
    ON_NEG_TRADE = 20;
    ON_STOP_ORDER = 21;
    ON_TRANS_REPLY = 22;
    ON_PARAM = 23;
    ON_QUOTE = 24;
    ON_CLEAN_UP = 25; // no data attached
}

message Firm {

    string firmid = 1;
    string firm_name = 2;
    int32 status = 3; // NUMBER in QLUA
    string exchange = 4;
}

message AllTrade {

    int64 trade_num = 1; // NUMBER in QLUA
    uint32 flags = 2; // NUMBER in QLUA
    string price = 3; // NUMBER in QLUA
    uint32 qty = 4; // NUMBER in QLUA
    string value = 5; // NUMBER in QLUA
    string accruedint = 6; // NUMBER in QLUA
    string yield = 7; // NUMBER in QLUA
    string settlecode = 8;
    string reporate = 9; // NUMBER in QLUA
    string repovalue = 10; // NUMBER in QLUA
    string repo2value = 11; // NUMBER in QLUA
    string repoterm = 12; // NUMBER in QLUA
    string sec_code = 13;
    string class_code = 14;
    DateTimeEntry datetime = 15; // TABLE in QLUA
    int32 period = 16; // NUMBER in QLUA
    string open_interest = 17; // NUMBER in QLUA
    string exchange_code = 18;
}

message Trade {

    int64 trade_num = 1; // NUMBER in QLUA
    int64 order_num = 2; // NUMBER in QLUA
    string brokerref = 3;
    string userid = 4;
    string firmid = 5;
    string canceled_uid = 6; // NUMBER in QLUA
    string account = 7;
    string price = 8; // NUMBER in QLUA
    uint32 qty = 9; // NUMBER in QLUA
    string value = 10; // NUMBER in QLUA
    string accruedint = 11; // NUMBER in QLUA
    string yield = 12; // NUMBER in QLUA
    string settlecode = 13;
    string cpfirmid = 14;
    uint32 flags = 15; // NUMBER in QLUA
    string price2 = 16; // NUMBER in QLUA
    string reporate = 17; // NUMBER in QLUA
    string client_code = 18;
    string accrued2 = 19; // NUMBER in QLUA
    string repoterm = 20; // NUMBER in QLUA
    string repovalue = 21; // NUMBER in QLUA
    string repo2value = 22; // NUMBER in QLUA
    string start_discount = 23; // NUMBER in QLUA
    string lower_discount = 24; // NUMBER in QLUA
    string upper_discount = 25; // NUMBER in QLUA
    string block_securities = 26; // NUMBER in QLUA
    string clearing_comission = 27; // NUMBER in QLUA
    string exchange_comission = 28; // NUMBER in QLUA
    string tech_center_comission = 29; // NUMBER in QLUA
    string settle_date = 30; // NUMBER in QLUA
    string settle_currency = 31;
    string trade_currency = 32;
    string exchange_code = 33;
    string station_id = 34;
    string sec_code = 35;
    string class_code = 36;
    DateTimeEntry datetime = 37; // TABLE in QLUA
    string bank_acc_id = 38;
    string broker_comission = 39; // NUMBER in QLUA
    string linked_trade = 40; // NUMBER in QLUA
    int32 period = 41; // NUMBER in QLUA
    string trans_id = 42; // NUMBER in QLUA; if not nullable then it should be of type long
    int32 kind = 43; // NUMBER in QLUA
    string clearing_bank_accid = 44;
    DateTimeEntry canceled_datetime = 45; // TABLE in QLUA
    string clearing_firmid = 46;
    string system_ref = 47;
    string uid = 48; // NUMBER in QLUA
}

message Order {

    int64 order_num = 1; // NUMBER in QLUA
    uint32 flags = 2; // NUMBER in QLUA
    string brokerref = 3;
    string userid = 4;
    string firmid = 5;
    string account = 6;
    string price = 7; // NUMBER in QLUA
    uint32 qty = 8; // NUMBER in QLUA
    string balance = 9; // NUMBER in QLUA
    string value = 10; // NUMBER in QLUA
    string accruedint = 11; // NUMBER in QLUA
    string yield = 12; // NUMBER in QLUA
    string trans_id = 13; // NUMBER in QLUA; if not nullable then it should be of type long
    string client_code = 14;
    string price2 = 15; // NUMBER in QLUA
    string settlecode = 16;
    string uid = 17; // NUMBER in QLUA
    string canceled_uid = 18; // NUMBER in QLUA
    string exchange_code = 19;
    string activation_time = 20; // NUMBER in QLUA
    string linkedorder = 21; // NUMBER in QLUA
    string expiry = 22; // NUMBER in QLUA
    string sec_code = 23;
    string class_code = 24;
    DateTimeEntry datetime = 25; // TABLE in QLUA
    DateTimeEntry withdraw_datetime = 26; // TABLE in QLUA
    string bank_acc_id = 27;
    int32 value_entry_type = 28; // NUMBER in QLUA
    string repoterm = 29; // NUMBER in QLUA
    string repovalue = 30; // NUMBER in QLUA
    string repo2value = 31; // NUMBER in QLUA
    string repo_value_balance = 32; // NUMBER in QLUA
    string start_discount = 33; // NUMBER in QLUA
    string reject_reason = 34;
    string ext_order_flags = 35; // NUMBER in QLUA; not documented as non-nilable, so it should be string
    uint32 min_qty = 36; // NUMBER in QLUA
    int32 exec_type = 37; // NUMBER in QLUA
    int32 side_qualifier = 38; // NUMBER in QLUA
    int32 acnt_type = 39; // NUMBER in QLUA
    int32 capacity = 40; // NUMBER in QLUA
    int32 passive_only_order = 41; // NUMBER in QLUA
    int32 visible = 42; // NUMBER in QLUA
}

message AccountBalance {

    string firmid = 1;
    string sec_code = 2;
    string trdaccid = 3;
    string depaccid = 4;
    string openbal = 5; // NUMBER in QLUA
    string currentpos = 6; // NUMBER in QLUA
    string plannedpossell = 7; // NUMBER in QLUA
    string plannedposbuy = 8; // NUMBER in QLUA
    string planbal = 9; // NUMBER in QLUA
    string usqtyb = 10; // NUMBER in QLUA
    string usqtys = 11; // NUMBER in QLUA
    string planned = 12; // NUMBER in QLUA
    string settlebal = 13; // NUMBER in QLUA
    string bank_acc_id = 14;
    int32 firmuse = 15; // NUMBER in QLUA
}

message FuturesLimit {

    string firmid = 1;
    string trdaccid = 2;
    int32 limit_type = 3; // NUMBER in QLUA
    string liquidity_coef = 4; // NUMBER in QLUA
    string cbp_prev_limit = 5; // NUMBER in QLUA
    string cbplimit = 6; // NUMBER in QLUA
    string cbplused = 7; // NUMBER in QLUA
    string cbplplanned = 8; // NUMBER in QLUA
    string varmargin = 9; // NUMBER in QLUA
    string accruedint = 10; // NUMBER in QLUA
    string cbplused_for_orders = 11; // NUMBER in QLUA
    string cbplused_for_positions = 12; // NUMBER in QLUA
    string options_premium = 13; // NUMBER in QLUA
    string ts_comission = 14; // NUMBER in QLUA
    string kgo = 15; // NUMBER in QLUA
    string currcode = 16;
    string real_varmargin = 17; // NUMBER in QLUA
}

message FuturesLimitDelete {

    string firmid = 1;
    int32 limit_type = 2; // NUMBER in QLUA
}

message FuturesClientHolding {

    string firmid = 1;
    string trdaccid = 2;
    string sec_code = 3;
    int32 type = 4; // NUMBER in QLUA
    string startbuy = 5; // NUMBER in QLUA
    string startsell = 6; // NUMBER in QLUA
    string todaybuy = 7; // NUMBER in QLUA
    string todaysell = 8; // NUMBER in QLUA
    string totalnet = 9; // NUMBER in QLUA
    uint32 openbuys = 10; // NUMBER in QLUA
    uint32 opensells = 11; // NUMBER in QLUA
    string cbplused = 12; // NUMBER in QLUA
    string cbplplanned = 13; // NUMBER in QLUA
    string varmargin = 14; // NUMBER in QLUA
    string avrposnprice = 15; // NUMBER in QLUA
    string positionvalue = 16; // NUMBER in QLUA
    string real_varmargin = 17; // NUMBER in QLUA
    string total_varmargin = 18; // NUMBER in QLUA
    int32 session_status = 19; // NUMBER in QLUA
}

message MoneyLimit {

    string currcode = 1;
    string tag = 2;
    string firmid = 3;
    string client_code = 4;
    string openbal = 5; // NUMBER in QLUA
    string openlimit = 6; // NUMBER in QLUA
    string currentbal = 7; // NUMBER in QLUA
    string currentlimit = 8; // NUMBER in QLUA
    string locked = 9; // NUMBER in QLUA
    string locked_value_coef = 10; // NUMBER in QLUA
    string locked_margin_value = 11; // NUMBER in QLUA
    string leverage = 12; // NUMBER in QLUA
    sint32 limit_kind = 13; // NUMBER in QLUA
}

message MoneyLimitDelete {

    string currcode = 1;
    string tag = 2;
    string client_code = 3;
    string firmid = 4;
    sint32 limit_kind = 5;
}

message DepoLimit {

    string sec_code = 1;
    string trdaccid = 2;
    string firmid = 3;
    string client_code = 4;
    sint32 openbal = 5; // NUMBER in QLUA
    uint32 openlimit = 6; // NUMBER in QLUA
    sint32 currentbal = 7; // NUMBER in QLUA
    uint32 currentlimit = 8; // NUMBER in QLUA
    uint32 locked_sell = 9; // NUMBER in QLUA
    uint32 locked_buy = 10; // NUMBER in QLUA
    string locked_buy_value = 11; // NUMBER in QLUA
    string locked_sell_value = 12; // NUMBER in QLUA
    string awg_position_price = 13; // NUMBER in QLUA
    sint32 limit_kind = 14; // NUMBER in QLUA
}

message DepoLimitDelete {

    string sec_code = 1;
    string trdaccid = 2;
    string firmid = 3;
    string client_code = 4;
    sint32 limit_kind = 5;
}

message AccountPosition {

    string firmid = 1;
    string currcode = 2;
    string tag = 3;
    string description = 4;
    string openbal = 5; // NUMBER in QLUA
    string currentpos = 6; // NUMBER in QLUA
    string plannedpos = 7; // NUMBER in QLUA
    string limit1 = 8; // NUMBER in QLUA
    string limit2 = 9; // NUMBER in QLUA
    string orderbuy = 10; // NUMBER in QLUA
    string ordersell = 11; // NUMBER in QLUA
    string netto = 12; // NUMBER in QLUA
    string plannedbal = 13; // NUMBER in QLUA
    string debit = 14; // NUMBER in QLUA
    string credit = 15; // NUMBER in QLUA
    string bank_acc_id = 16;
    string margincall = 17; // NUMBER in QLUA
    string settlebal = 18; // NUMBER in QLUA
}

message NegDeal {

    int64 neg_deal_num = 1; // NUMBER in QLUA
    string neg_deal_time = 2; // NUMBER in QLUA
    int32 flags = 3; // NUMBER in QLUA
    string brokerref = 4;
    string userid = 5;
    string firmid = 6;
    string cpuserid = 7;
    string cpfirmid = 8;
    string account = 9;
    string price = 10; // NUMBER in QLUA
    int32 qty = 11; // NUMBER in QLUA
    string matchref = 12;
    string settlecode = 13;
    string yield = 14; // NUMBER in QLUA
    string accruedint = 15; // NUMBER in QLUA
    string value = 16; // NUMBER in QLUA
    string price2 = 17; // NUMBER in QLUA
    string reporate = 18; // NUMBER in QLUA
    string refundrate = 19; // NUMBER in QLUA
    string trans_id = 20; // NUMBER in QLUA
    string client_code = 21;
    int32 repoentry = 22;
    string repovalue = 23; // NUMBER in QLUA
    string repo2value = 24; // NUMBER in QLUA
    string repoterm = 25; // NUMBER in QLUA
    string start_discount = 26; // NUMBER in QLUA
    string lower_discount = 27; // NUMBER in QLUA
    string upper_discount = 28; // NUMBER in QLUA
    string block_securities = 29; // NUMBER in QLUA
    string uid = 30; // NUMBER in QLUA
    string withdraw_time = 31; // NUMBER in QLUA
    string neg_deal_date = 32; // NUMBER in QLUA
    string balance = 33; // NUMBER in QLUA
    string origin_repovalue = 34; // NUMBER in QLUA
    string origin_qty = 35; // NUMBER in QLUA
    string origin_discount = 36; // NUMBER in QLUA
    string neg_deal_activation_date = 37; // NUMBER in QLUA
    string neg_deal_activation_time = 38; // NUMBER in QLUA
    string quoteno = 39; // NUMBER in QLUA
    string settle_currency = 40;
    string sec_code = 41;
    string class_code = 42;
    string bank_acc_id = 43;
    string withdraw_date = 44; // NUMBER in QLUA
    string linkedorder = 45; // NUMBER in QLUA
    DateTimeEntry activation_date_time = 46; // TABLE in QLUA
    DateTimeEntry withdraw_date_time = 47; // TABLE in QLUA
    DateTimeEntry date_time = 48; // TABLE in QLUA
}

message NegTrade {

    int64 trade_num = 1; // NUMBER in QLUA
    string trade_date = 2; // NUMBER in QLUA
    string settle_date = 3; // NUMBER in QLUA
    int32 flags = 4; // NUMBER in QLUA
    string brokerref = 5;
    string firmid = 6;
    string account = 7;
    string cpfirmid = 8;
    string cpaccount = 9;
    string price = 10; // NUMBER in QLUA
    uint32 qty = 11; // NUMBER in QLUA
    string value = 12; // NUMBER in QLUA
    string settlecode = 13;
    string report_num = 14; // NUMBER in QLUA
    string cpreport_num = 15; // NUMBER in QLUA
    string accruedint = 16; // NUMBER in QLUA
    string repotradeno = 17; // NUMBER in QLUA
    string price1 = 18; // NUMBER in QLUA
    string reporate = 19; // NUMBER in QLUA
    string price2 = 20; // NUMBER in QLUA
    string client_code = 21;
    string ts_comission = 22; // NUMBER in QLUA
    string balance = 23; // NUMBER in QLUA
    string settle_time = 24; // NUMBER in QLUA
    string amount = 25; // NUMBER in QLUA
    string repovalue = 26; // NUMBER in QLUA
    string repoterm = 27; // NUMBER in QLUA
    string repo2value = 28; // NUMBER in QLUA
    string return_value = 29; // NUMBER in QLUA
    string discount = 30; // NUMBER in QLUA
    string lower_discount = 31; // NUMBER in QLUA
    string upper_discount = 32; // NUMBER in QLUA
    string block_securities = 33; // NUMBER in QLUA
    string urgency_flag = 34; // NUMBER in QLUA
    int32 type = 35; // NUMBER in QLUA
    int32 operation_type = 36; // NUMBER in QLUA
    string expected_discount = 37; // NUMBER in QLUA
    string expected_quantity = 38; // NUMBER in QLUA
    string expected_repovalue = 39; // NUMBER in QLUA
    string expected_repo2value = 40; // NUMBER in QLUA
    string expected_return_value = 41; // NUMBER in QLUA
    string order_num = 42; // NUMBER in QLUA
    string report_trade_date = 43; // NUMBER in QLUA
    int32 settled = 44;  // NUMBER in QLUA
    int32 clearing_type = 45; // NUMBER in QLUA
    string report_comission = 46; // NUMBER in QLUA
    string coupon_payment = 47; // NUMBER in QLUA
    string principal_payment = 48; // NUMBER in QLUA
    string principal_payment_date = 49; // NUMBER in QLUA
    string nextdaysettle = 50; // NUMBER in QLUA
    string settle_currency = 51;
    string sec_code = 52;
    string class_code = 53;
    string compval = 54; // NUMBER in QLUA
    string parenttradeno = 55; // NUMBER in QLUA
    string bankid = 56;
    string bankaccid = 57;
    string precisebalance = 58; // NUMBER in QLUA
    string confirmtime = 59; // NUMBER in QLUA
    int32 ex_flags = 60; // NUMBER in QLUA
    string confirmreport = 61; // NUMBER in QLUA
}

message StopOrder {

    int64 order_num = 1; // NUMBER in QLUA
    string ordertime = 2; // NUMBER in QLUA
    int32 flags = 3; // NUMBER in QLUA
    string brokerref = 4;
    string firmid = 5;
    string account = 6;
    int32 condition = 7; // NUMBER in QLUA
    string condition_price = 8; // NUMBER in QLUA
    string price = 9; // NUMBER in QLUA
    uint32 qty = 10; // NUMBER in QLUA
    string linkedorder = 11; // NUMBER in QLUA
    string expiry = 12; // NUMBER in QLUA
    string trans_id = 13; // NUMBER in QLUA
    string client_code = 14;
    string co_order_num = 15; // NUMBER in QLUA
    string co_order_price = 16; // NUMBER in QLUA
    int32 stop_order_type = 17; // NUMBER in QLUA
    string orderdate = 18; // NUMBER in QLUA
    string alltrade_num = 19; // NUMBER in QLUA
    int32 stopflags = 20; // NUMBER in QLUA
    string offset = 21; // NUMBER in QLUA
    string spread = 22; // NUMBER in QLUA
    string balance = 23; // NUMBER in QLUA
    string uid = 24; // NUMBER in QLUA
    uint32 filled_qty = 25; // NUMBER in QLUA
    string withdraw_time = 26; // NUMBER in QLUA
    string condition_price2 = 27; // NUMBER in QLUA
    string active_from_time = 28; // NUMBER in QLUA
    string active_to_time = 29; // NUMBER in QLUA
    string sec_code = 30;
    string class_code = 31;
    string condition_sec_code = 32;
    string condition_class_code = 33;
    string canceled_uid = 34; // NUMBER in QLUA
    DateTimeEntry order_date_time = 35; // TABLE in QLUA
    DateTimeEntry withdraw_datetime = 36; // TABLE in QLUA
}

message TransReply {

    int64 trans_id = 1; // NUMBER in QLUA
    int32 status = 2; // NUMBER in QLUA
    string result_msg = 3;
    DateTimeEntry date_time = 4; // TABLE in QLUA
    string uid = 5; // NUMBER in QLUA
    int32 flags = 6; // NUMBER in QLUA
    string server_trans_id = 7; // NUMBER in QLUA
    string order_num = 8; // NUMBER in QLUA
    string price = 9; // NUMBER in QLUA
    string quantity = 10; // NUMBER in QLUA
    string balance = 11; // NUMBER in QLUA
    string firm_id = 12;
    string account = 13;
    string client_code = 14;
    string brokerref = 15;
    string class_code = 16;
    string sec_code = 17;
    string exchange_code = 18;
}

message ParamEventData {

    string class_code = 1;
    string sec_code = 2;
}

message QuoteEventData {

    string class_code = 1;
    string sec_code = 2;
}

message Qlua_Request {

    ProcedureType type = 2;
    bytes args = 3; // the protoc-lua-plugin gives out a corrupted .lua file if we're using google.protobuf.Any
}

message Qlua_Response {

    ProcedureType type = 1;
    bool is_error = 2;
    bytes result = 3;
}

message IsConnected_Result {
    int32 is_connected = 1;
}

message GetScriptPath_Result {
    string script_path = 1;
}

message GetInfoParam_Request {

    // Хотел сделать enum-ом, чтобы меньше слать по wire, но в используемой Lua-реализации
    // protobuf'a нет адекватного способа вернуть строковое имя enum'а, поэтому говнокод, который
    // надо будет для этого написать, скорее всего нивелирует какой-либо перфомансный 
    // профит от enum'ов в данном случае. К тому же, при добавлении новых видов paramName 
    // при использовании строк ничего не надо будет перекомпилировать.
    string param_name = 1;  
}

message GetInfoParam_Result {
    string info_param = 1;
}

message Message_Request {

    string message = 1;
    MessageIconType icon_type = 2;
}

message Message_Result {
    int32 result = 1;
}

message Sleep_Request {
    int32 time = 1;
}

message Sleep_Result {
    int32 result = 1;
}

message GetWorkingFolder_Result {
    string working_folder = 1;
}

message PrintDbgStr_Request {
    string s = 1;
}

message GetItem_Request {

    string table_name = 1;
    int32 index = 2;
}

message GetItem_Result {
    map<string, string> table_row = 1;
}

message GetOrderByNumber_Request {

    string class_code = 1;
    uint32 order_id = 2;
}

message GetOrderByNumber_Result {

    repeated TableEntry order = 1;
    int32 indx = 2;
}

message GetNumberOf_Request {
    string table_name = 1;
}

message GetNumberOf_Result {
    int32 result = 1;
}

message SearchItems_Request {

    string table_name = 1;
    int32 start_index = 2;
    
    // Для удобства 0 интерпретируется как getNumberOf(table_name) - 1
    int32 end_index = 3; 
    
    // Формат функции без использования params: "function (TABLE t) ... end", возвращаемые значения: BOOLEAN, nil; 
    // где t -- строка таблицы table_name со всеми параметрами.
    // Формат функции при использовании params: "function (p1, p2, ...) ... end", возвращаемые значения: BOOLEAN, nil; 
    // где p1, p2, ... -- значения параметров, заказанных в params
    
    // Внимание! По результам тестирования возврат nil из fn не приводит к ожидаемому результату (возврат списка уже пройденных индексов, удовлетворяющих условию + индекс, на котором возвратили nil + остановка процесса проверки условия) -- вместо этого процесс проверки условия прерывается и функция SearchItems возвращает nil. Подозреваю, что это баг в QLUA или ошибка в документации.
    string fn_def = 4; 
    
    string params = 5;
}

message SearchItems_Result {
    repeated int32 items_indices = 1; 
    //NB: Недоработка QLUA: пустой список индексов возвращается в виде nil, и ошибка при работе фукнции проверки элемента (fn)
    //тоже приводит к возврату nil, так что непонятно, не нашли ли мы удовлетворяющих условию элементов или написали ошибочную
    //функцию проверки условия. Для определённости, в обоих случаях будем возвращать пустой список.--]]
}

message GetClassesList_Result {
    string classes_list = 1;
}

message GetClassInfo_Request {
    string class_code = 1;
}

message GetClassInfo_Result {
    map<string, string> class_info = 1;
}

message GetClassSecurities_Request {
    string class_code = 1;
}

message GetClassSecurities_Result {
    string class_securities = 1;
}

message GetMoney_Request {

    string client_code = 1; // Код клиента
    string firmid = 2; // Фирма
    string tag = 3; // Группа
    string currcode = 4; // Валюта
}

message GetMoney_Result {
    map<string, string> money = 1;
}

message GetMoneyEx_Request {

    string firmid = 1; // Фирма
    string client_code = 2; // Код клиента
    string tag = 3; // Группа
    string currcode = 4; // Валюта
    int32 limit_kind = 5; // Вид лимита (Как задать лимит "Tx"? Ответ: видимо, никак -- это недоработка в API qlua)
}

message GetMoneyEx_Result {
    map<string, string> money_ex = 1;
}

message GetDepo_Request {

    string client_code = 1; // Код клиента
    string firmid = 2; // Фирма
    string sec_code = 3; // Код бумаги
    string trdaccid = 4; // Счет депо
}

message GetDepo_Result {
    map<string, string> depo = 1;
}

message GetDepoEx_Request {

    string firmid = 1; // Фирма
    string client_code = 2; // Код клиента
    string sec_code = 3; // Код бумаги
    string trdaccid = 4; // Счет депо
    int32 limit_kind = 5; // Вид лимита (Как задать лимит "Tx"? Ответ: видимо, никак -- это недоработка в API qlua)
}

message GetDepoEx_Result {
    map<string, string> depo_ex = 1;
}

message GetFuturesLimit_Request {

    string firmid = 1;
    string trdaccid = 2;
    int32 limit_type = 3;
    string currcode = 4;
}

message GetFuturesLimit_Result {
    map<string, string> futures_limit = 1;
}

message GetFuturesHolding_Request {

    string firmid = 1;
    string trdaccid = 2;
    string sec_code = 3;
    int32 type = 4;
}

message GetFuturesHolding_Result {
    map<string, string> futures_holding = 1;
}

message GetSecurityInfo_Request {

    string class_code = 1;
    string sec_code = 2;
}

message GetSecurityInfo_Result {
    map<string, string> security_info = 1;
}

message GetTradeDate_Result {
    map<string, string> trade_date = 1;
}

message GetQuoteLevel2_Request {

    string class_code = 1;
    string sec_code = 2;
}

message GetQuoteLevel2_Result {

    message QuoteEntry {
    
        string price = 1;
        string quantity = 2;
    }

    string bid_count = 1;
    string offer_count = 2;
    repeated QuoteEntry bids = 3;
    repeated QuoteEntry offers = 4;
}

message GetLinesCount_Request {
    string tag = 1;
}

message GetLinesCount_Result {
    int32 lines_count = 1;
}

message GetNumCandles_Request {
    string tag = 1;
}

message GetNumCandles_Result {
    int32 num_candles = 1;
}

message GetCandlesByIndex_Request {

    string tag = 1;
    int32 line = 2;
    int32 first_candle = 3;
    int32 count = 4;
}

message GetCandlesByIndex_Result {

    repeated CandleEntry t = 1;
    int32 n = 2;
    string l = 3;
}

message CreateDataSource_Request {

    string class_code = 1;
    string sec_code = 2;
    Interval interval = 3;
    string param = 4;
}

message CreateDataSource_Result {

    string datasource_uuid = 1; 
    bool is_error = 2;
    string error_desc = 3;
}

message DataSourceSetUpdateCallback_Request {

    string datasource_uuid = 1; 
    string f_cb_def = 2; // NB: формат функции: "function (NUMBER index, TABLE datasource) function_body end"
}

message DataSourceSetUpdateCallback_Result {
    bool result = 1;
}

message DataSourceO_Request {

    string datasource_uuid = 1;
    int32 candle_index = 2;
}

message DataSourceO_Result {
    string value = 1; // use of string instead of double for a safe money representation
}

message DataSourceH_Request {

    string datasource_uuid = 1;
    int32 candle_index = 2;
}

message DataSourceH_Result {
    string value = 1; // use of string instead of double for a safe money representation
}

message DataSourceL_Request {

    string datasource_uuid = 1;
    int32 candle_index = 2;
}

message DataSourceL_Result {
    string value = 1; // use of string instead of double for a safe money representation
}

message DataSourceC_Request {

    string datasource_uuid = 1;
    int32 candle_index = 2;
}

message DataSourceC_Result {
    string value = 1; // use of string instead of double for a safe money representation
}

message DataSourceV_Request {

    string datasource_uuid = 1;
    int32 candle_index = 2;
}

message DataSourceV_Result {
    string value = 1; // use of string instead of double for a safe quantity representation
}

message DataSourceT_Request {

    string datasource_uuid = 1;
    int32 candle_index = 2;
}

message DataSourceT_Result {

    int32 year = 1;
    int32 month = 2;
    int32 day = 3;
    int32 week_day = 4;
    int32 hour = 5;
    int32 min = 6;
    int32 sec = 7;
    int32 ms = 8;
    int32 count = 9;
}

message DataSourceSize_Request {
    string datasource_uuid = 1;
}

message DataSourceSize_Result {
    int32 value = 1;
}

message DataSourceClose_Request {
    string datasource_uuid = 1;
}

message DataSourceClose_Result {
    bool result = 1;
}

message DataSourceSetEmptyCallback_Request {
    string datasource_uuid = 1;
}

message DataSourceSetEmptyCallback_Result {
    bool result = 1;
}

message SendTransaction_Request {
    map<string, string> transaction = 1;
}

message SendTransaction_Result {
    string result = 1;
}

message CalcBuySell_Request {

    string class_code = 1;
    string sec_code = 2;
    string client_code = 3;
    string account = 4;
    string price = 5;
    bool is_buy = 6;
    bool is_market = 7;
}

message CalcBuySell_Result {

    int32 qty = 1;
    string comission = 2;
}

message GetParamEx_Request {

    string class_code = 1;
    string sec_code = 2;
    string param_name = 3; // возможные значения для этого параметра можно найти тут: https://quikluacsharp.ru/quik-qlua/poluchenie-dannyh-iz-tablits-quik-v-qlua-lua/
}

message GetParamEx_Result {
    map<string, string> param_ex = 1;
}

message GetPortfolioInfo_Request {

    string firm_id = 1;
    string client_code = 2;
}

message GetPortfolioInfo_Result {
    map<string, string> portfolio_info = 1;
}

message GetPortfolioInfoEx_Request {

    string firm_id = 1;
    string client_code = 2;
    int32 limit_kind = 3;
}

message GetPortfolioInfoEx_Result {
    map<string, string> portfolio_info_ex = 1;
}

message GetBuySellInfo_Request {

    string firm_id = 1;
    string client_code = 2;
    string class_code = 3;
    string sec_code = 4;
    string price = 5;
}

message GetBuySellInfo_Result {
    map<string, string> buy_sell_info = 1;
}

// Важно! Это не указано в документации к Quik:
// добавлять столбцы нужно перед вызовом CreateWindow для указанной таблице. Иначе потом
// вызовы AddColumn будут возвращать ответ, что столбец добавлен, но визуально ничего не изменится.
// Я даже пробовал скрывать таблицу и создавать новое окно для неё, но всё равно добавленные 
// между делом столбцы не отобразились.
message AddColumn_Request {

    int32 t_id = 1;
    int32 icode = 2;
    string name = 3;
    bool is_default = 4;
    ColumnParameterType par_type = 5;
    int32 width = 6;
}

message AddColumn_Result {
    int32 result = 1;
}

message AllocTable_Result {
    int32 t_id = 1;
}

message Clear_Request {
    int32 t_id = 1;
}

message Clear_Result {
    bool result = 1;
}

message CreateWindow_Request {
    int32 t_id = 1;
}

message CreateWindow_Result {
    int32 result = 1;
}

message DeleteRow_Request {

    int32 t_id = 1;
    int32 key = 2;
}

message DeleteRow_Result {
    bool result = 1;
}

message DestroyTable_Request {
    int32 t_id = 1;
}

message DestroyTable_Result {
    bool result = 1;
}

message InsertRow_Request {

    int32 t_id = 1;
    sint32 key = 2;
}

message InsertRow_Result {
    sint32 result = 1;
}

message IsWindowClosed_Request {
    int32 t_id = 1;
}

message IsWindowClosed_Result {
    bool result = 1;
}

message GetCell_Request {

    int32 t_id = 1;
    int32 key = 2;
    int32 code = 3;
}

message GetCell_Result {

    string image = 1;
    string value = 2; // the parsing is left to be done on the client side, the library returns it as 0 if the cell's number is not set, so "0" goes on the wire in that case
}

message SetCell_Request {

    int32 t_id = 1;
    int32 key = 2;
    int32 code = 3;
    string text = 4;
    string value = 5;
}

message SetCell_Result {
    bool result = 1;
}

message SetWindowCaption_Request {

    int32 t_id = 1;
    string str = 2;
}

message SetWindowCaption_Result {
    bool result = 1;
}

message SetWindowPos_Request {

    int32 t_id = 1;
    sint32 x = 2;
    sint32 y = 3;
    sint32 dx = 4;
    sint32 dy = 5;
}

message SetWindowPos_Result {
    bool result = 1;
}

message SetTableNotificationCallback_Request {

    int32 t_id = 1;
    string f_cb_def = 2;
}

message SetTableNotificationCallback_Result {
    int32 result = 1;
}

message GetTableSize_Request {
    int32 t_id = 1;
}

message GetTableSize_Result {

    int32 rows = 1;
    int32 col = 2;
}

message GetWindowCaption_Request {
    int32 t_id = 1;
}

message GetWindowCaption_Result {
    string caption = 1;
}

message GetWindowRect_Request {
    int32 t_id = 1;
}

message GetWindowRect_Result {

    sint32 top = 1;
    sint32 left = 2;
    sint32 bottom = 3;
    sint32 right = 4;
}

// NB: на самом деле, библиотечная функция RGB должна называться BGR, ибо она выдаёт числа именно в этом формате. В SetColor, однако, тоже ожидается цвет в формате BGR, так что это не баг, а фича.
message RGB_Request {

    int32 red = 1;
    int32 green = 2;
    int32 blue = 3;
}

message RGB_Result {
    int32 result = 1;
}

message SetColor_Request {

    int32 t_id = 1;
    sint32 row = 2;
    sint32 col = 3;
    int32 b_color = 4;
    int32 f_color = 5;
    int32 sel_b_color = 6;
    int32 sel_f_color = 7;
}

message SetColor_Result {
    bool result = 1;
}

message Highlight_Request {

    int32 t_id = 1;
    sint32 row = 2;
    sint32 col = 3;
    int32 b_color = 4;
    int32 f_color = 5;
    int64 timeout = 6;
}

message Highlight_Result {
    bool result = 1;
}

message SetSelectedRow_Request {

    int32 table_id = 1;
    sint32 row = 2;
}

message SetSelectedRow_Result {
    sint32 result = 1;
}

message AddLabel_Request {

    string chart_tag = 1;
    map<string, string> label_params = 2;
}

message AddLabel_Result {
    int32 label_id = 1;
}

message DelLabel_Request {

    string chart_tag = 1;
    int32 label_id = 2;
}

message DelLabel_Result {
    bool result = 1;
}

message DelAllLabels_Request {
    string chart_tag = 1;
}

message DelAllLabels_Result {
    bool result = 1;
}

message GetLabelParams_Request {

    string chart_tag = 1;
    int32 label_id = 2;
}

message GetLabelParams_Result {
    map<string, string> label_params = 1;
}

message SetLabelParams_Request {

    string chart_tag = 1;
    int32 label_id = 2;
    map<string, string> label_params = 3;
}

message SetLabelParams_Result {
    bool result = 1;
}

message SubscribeLevel2Quotes_Request {

    string class_code = 1;
    string sec_code = 2;
}

message SubscribeLevel2Quotes_Result {
    bool result = 1;
}

message UnsubscribeLevel2Quotes_Request {

    string class_code = 1;
    string sec_code = 2;
}

message UnsubscribeLevel2Quotes_Result {
    bool result = 1;
}

message IsSubscribedLevel2Quotes_Request {

    string class_code = 1;
    string sec_code = 2;
}

message IsSubscribedLevel2Quotes_Result {
    bool result = 1;
}

message ParamRequest_Request {

    string class_code = 1;
    string sec_code = 2;
    string db_name = 3;
}

message ParamRequest_Result {
    bool result = 1;
}

message CancelParamRequest_Request {

    string class_code = 1;
    string sec_code = 2;
    string db_name = 3;
}

message CancelParamRequest_Result {
    bool result = 1;
}

message BitToHex_Request {

    int32 x = 1;
    int32 n = 2; // 0 counts as "parameter not set"
}

message BitToHex_Result {
    string result = 1;
}

message BitBNot_Request {
    int32 x = 1;
}

message BitBNot_Result {
    int32 result = 1;
}

message BitBAnd_Request {

    int32 x1 = 1;
    int32 x2 = 2;
    repeated int32 xi = 3;
}

message BitBAnd_Result {
    int32 result = 1;
}

message BitBOr_Request {

    int32 x1 = 1;
    int32 x2 = 2;
    repeated int32 xi = 3;
}

message BitBOr_Result {
    int32 result = 1;
}

message BitBXor_Request {

    int32 x1 = 1;
    int32 x2 = 2;
    repeated int32 xi = 3;
}

message BitBXor_Result {
    int32 result = 1;
}
